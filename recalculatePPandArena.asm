// recalc PP
void recalculatePPandArena() {
  // prosperity part
  prosperity = 0
  
  for(r16 = 3; r16 < 59; r16++) {
    level = load(0x12CED1 + r16 * 0x34)
    
    if(level < 3) // Fresh / In Training
      continue
      
    if(isTriggerSet(200 + r16) == 0)
      continue
    
    if(r16 == 11 || r16 == 39 || r16 == 53) {
      prosperity += 1
      continue
    }
    
    ppValue = level - 2
    prosperity += ppValue
  }
  
  setPStat(1, prosperity)
  
  // arena part
  if(readPStat(3) < 23)
    return
    
  if(isTriggerSet(37) != 0)
    unsetTrigger(37)
    
  if(isTriggerSet(38) != 0)
    unsetTrigger(38)
    
  if(isTriggerSet(39) != 0)
    unsetTrigger(39)
}

0x000efa18 addiu r29,r29,0xffd8
0x000efa1c sw r31,0x0020(r29)
0x000efa20 sw r19,0x001c(r29)
0x000efa24 sw r18,0x0018(r29)
0x000efa28 sw r17,0x0014(r29)
0x000efa2c sw r16,0x0010(r29)
0x000efa30 addu r17,r0,r0
0x000efa34 addiu r16,r0,0x0003
0x000efa38 addiu r18,r0,0x009c
0x000efa3c beq r0,r0,0x000efad4
0x000efa40 addiu r19,r0,0x00cb
0x000efa44 lui r2,0x8013
0x000efa48 addiu r2,r2,0xced1
0x000efa4c addu r2,r2,r18
0x000efa50 lbu r2,0x0000(r2)
0x000efa54 nop
0x000efa58 sltiu r1,r2,0x0003
0x000efa5c bne r1,r0,0x000efac8
0x000efa60 nop
0x000efa64 jal 0x0010643c
0x000efa68 andi r4,r19,0xffff
0x000efa6c beq r2,r0,0x000efac8
0x000efa70 nop
0x000efa74 addiu r1,r0,0x000b
0x000efa78 beq r16,r1,0x000efa98
0x000efa7c nop
0x000efa80 addiu r1,r0,0x0027
0x000efa84 beq r16,r1,0x000efa98
0x000efa88 nop
0x000efa8c addiu r1,r0,0x0035
0x000efa90 bne r16,r1,0x000efaa4
0x000efa94 nop
0x000efa98 addiu r2,r17,0x0001
0x000efa9c beq r0,r0,0x000efac8
0x000efaa0 andi r17,r2,0x00ff
0x000efaa4 lui r2,0x8013
0x000efaa8 addiu r2,r2,0xced1
0x000efaac addu r2,r2,r18
0x000efab0 lbu r2,0x0000(r2)
0x000efab4 nop
0x000efab8 addi r2,r2,-0x0002
0x000efabc andi r2,r2,0x00ff
0x000efac0 addu r2,r17,r2
0x000efac4 andi r17,r2,0x00ff
0x000efac8 addi r16,r16,0x0001
0x000efacc addi r19,r19,0x0001
0x000efad0 addi r18,r18,0x0034
0x000efad4 slti r1,r16,0x003b
0x000efad8 bne r1,r0,0x000efa44
0x000efadc nop
0x000efae0 addiu r4,r0,0x0001
0x000efae4 jal 0x00106474
0x000efae8 addu r5,r17,r0
0x000efaec jal 0x001062e0
0x000efaf0 addiu r4,r0,0x0003
0x000efaf4 andi r17,r2,0x00ff
0x000efaf8 sltiu r1,r17,0x0017
0x000efafc bne r1,r0,0x000efb4c
0x000efb00 nop
0x000efb04 jal 0x0010643c
0x000efb08 addiu r4,r0,0x0025
0x000efb0c beq r2,r0,0x000efb1c
0x000efb10 nop
0x000efb14 jal 0x001065fc
0x000efb18 addiu r4,r0,0x0025
0x000efb1c jal 0x0010643c
0x000efb20 addiu r4,r0,0x0026
0x000efb24 beq r2,r0,0x000efb34
0x000efb28 nop
0x000efb2c jal 0x001065fc
0x000efb30 addiu r4,r0,0x0026
0x000efb34 jal 0x0010643c
0x000efb38 addiu r4,r0,0x0027
0x000efb3c beq r2,r0,0x000efb4c
0x000efb40 nop
0x000efb44 jal 0x001065fc
0x000efb48 addiu r4,r0,0x0027
0x000efb4c lw r31,0x0020(r29)
0x000efb50 lw r19,0x001c(r29)
0x000efb54 lw r18,0x0018(r29)
0x000efb58 lw r17,0x0014(r29)
0x000efb5c lw r16,0x0010(r29)
0x000efb60 jr r31
0x000efb64 addiu r29,r29,0x0028