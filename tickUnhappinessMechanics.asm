void tickUnhappinessMechanics() {
  happiness = load(0x13848A)
  currentFrame = load(0x134F08)
  previousFrame = load(0x134F06)
  
  // perform unhappiness check every 200 frames
  if(load(0x138460) == 0 && happiness < 0 && currentFrame % 200 == 0 && currentFrame != previousFrame) {
    chance = -happiness - load(0x138488) // discipline
    
    if(random(100)) < chance)
      store(0x138460, load(0x138460) | 0x10)
  }
  
  // unhappiness tick
  if(load(0x138460) & 0x10 != 0 && currentFrame != previousFrame) {
    // increase happiness by 1 per 15 frames
    if(currentFrame % 15 == 0)
      store(0x13848A, load(0x13848A) + 1)
    
    // reduce stats by 2% per 300 frames
    if(currentFrame % 300 == 0) {
      dataPtr = 0x1557E0
      
      store(dataPtr + 0x10, load(dataPtr + 0x10) * 0.98)
      store(dataPtr + 0x12, load(dataPtr + 0x12) * 0.98)
      store(dataPtr + 0x00, load(dataPtr + 0x00) * 0.98)
      store(dataPtr + 0x02, load(dataPtr + 0x02) * 0.98)
      store(dataPtr + 0x04, load(dataPtr + 0x04) * 0.98)
      store(dataPtr + 0x06, load(dataPtr + 0x06) * 0.98)
      
      if(load(dataPtr + 0x10) <= 0)
        store(dataPtr + 0x10, 1)
      if(load(dataPtr + 0x12) <= 0)
        store(dataPtr + 0x12, 1)
      if(load(dataPtr + 0x00) <= 0)
        store(dataPtr + 0x00, 1)
      if(load(dataPtr + 0x02) <= 0)
        store(dataPtr + 0x02, 1)
      if(load(dataPtr + 0x04) <= 0)
        store(dataPtr + 0x04, 1)
      if(load(dataPtr + 0x06) <= 0)
        store(dataPtr + 0x06, 1)
      
      maxHP = load(dataPtr + 0x10)
      currentHP = load(dataPtr + 0x14)
      
      if(currentHP >= maxHP)
        store(dataPtr + 0x14, maxHP)
      
      maxMP = load(dataPtr + 0x12)
      currentMP = load(dataPtr + 0x16)
      
      if(currentMP >= maxMP)
        store(dataPtr + 0x16, maxMP)
    }
  }
  
  // remove butterfly if happiness is >= 0
  conditionFlag = load(0x138460)
  happiness = load(0x13848A)
    
  if(conditionFlag & 0x10 != 0 && happiness >= 0) {
    store(0x138460, conditionFlag & 0xFFEF)
    
    store(0x1557D7, 1)
    unsetButterfly(load(0x134C60))
    store(0x134C54, -1)
  }
}

0x000a5ea0 addiu r29,r29,0xffe8
0x000a5ea4 lui r1,0x8014
0x000a5ea8 sw r31,0x0014(r29)
0x000a5eac lw r2,-0x7ba0(r1)
0x000a5eb0 nop
0x000a5eb4 bne r2,r0,0x000a5f50
0x000a5eb8 sw r16,0x0010(r29)
0x000a5ebc lui r1,0x8014
0x000a5ec0 lh r2,-0x7b76(r1)
0x000a5ec4 nop
0x000a5ec8 bgez r2,0x000a5f50
0x000a5ecc addu r5,r2,r0
0x000a5ed0 lhu r3,-0x6c24(r28)
0x000a5ed4 addiu r2,r0,0x00c8
0x000a5ed8 div r3,r2
0x000a5edc mfhi r2
0x000a5ee0 bne r2,r0,0x000a5f50
0x000a5ee4 addu r4,r3,r0
0x000a5ee8 lhu r2,-0x6c26(r28)
0x000a5eec nop
0x000a5ef0 beq r4,r2,0x000a5f50
0x000a5ef4 nop
0x000a5ef8 sll r16,r5,0x10
0x000a5efc bgez r5,0x000a5f10
0x000a5f00 sra r16,r16,0x10
0x000a5f04 sub r2,r0,r5
0x000a5f08 sll r16,r2,0x10
0x000a5f0c sra r16,r16,0x10
0x000a5f10 jal 0x000a36d4
0x000a5f14 addiu r4,r0,0x0064
0x000a5f18 sll r3,r2,0x10
0x000a5f1c lui r1,0x8014
0x000a5f20 lh r2,-0x7b78(r1)
0x000a5f24 sra r3,r3,0x10
0x000a5f28 sub r2,r16,r2
0x000a5f2c slt r1,r3,r2
0x000a5f30 beq r1,r0,0x000a5f50
0x000a5f34 nop
0x000a5f38 lui r1,0x8014
0x000a5f3c lw r2,-0x7ba0(r1)
0x000a5f40 nop
0x000a5f44 ori r2,r2,0x0010
0x000a5f48 lui r1,0x8014
0x000a5f4c sw r2,-0x7ba0(r1)
0x000a5f50 lui r1,0x8014
0x000a5f54 lw r2,-0x7ba0(r1)
0x000a5f58 nop
0x000a5f5c andi r2,r2,0x0010
0x000a5f60 beq r2,r0,0x000a61c4
0x000a5f64 nop
0x000a5f68 lhu r3,-0x6c24(r28)
0x000a5f6c addiu r2,r0,0x000f
0x000a5f70 div r3,r2
0x000a5f74 addu r4,r3,r0
0x000a5f78 mfhi r2
0x000a5f7c bne r2,r0,0x000a5fac
0x000a5f80 addu r5,r3,r0
0x000a5f84 lhu r2,-0x6c26(r28)
0x000a5f88 nop
0x000a5f8c beq r4,r2,0x000a5fac
0x000a5f90 nop
0x000a5f94 lui r1,0x8014
0x000a5f98 lh r2,-0x7b76(r1)
0x000a5f9c nop
0x000a5fa0 addi r2,r2,0x0001
0x000a5fa4 lui r1,0x8014
0x000a5fa8 sh r2,-0x7b76(r1)
0x000a5fac addiu r2,r0,0x012c
0x000a5fb0 div r5,r2
0x000a5fb4 mfhi r2
0x000a5fb8 bne r2,r0,0x000a61c4
0x000a5fbc nop
0x000a5fc0 lhu r2,-0x6c26(r28)
0x000a5fc4 nop
0x000a5fc8 beq r4,r2,0x000a61c4
0x000a5fcc nop
0x000a5fd0 lui r3,0x8015
0x000a5fd4 addiu r3,r3,0x57e0
0x000a5fd8 lh r6,0x0010(r3)
0x000a5fdc lui r2,0x51eb
0x000a5fe0 sll r4,r6,0x01
0x000a5fe4 ori r2,r2,0x851f
0x000a5fe8 mult r2,r4
0x000a5fec srl r5,r4,0x1f
0x000a5ff0 mfhi r4
0x000a5ff4 sra r4,r4,0x05
0x000a5ff8 addu r4,r4,r5
0x000a5ffc sll r4,r4,0x10
0x000a6000 sra r4,r4,0x10
0x000a6004 sub r4,r6,r4
0x000a6008 sh r4,0x0010(r3)
0x000a600c lh r6,0x0012(r3)
0x000a6010 addu r4,r2,r0
0x000a6014 sll r5,r6,0x01
0x000a6018 mult r4,r5
0x000a601c mfhi r4
0x000a6020 srl r5,r5,0x1f
0x000a6024 sra r4,r4,0x05
0x000a6028 addu r4,r4,r5
0x000a602c sll r4,r4,0x10
0x000a6030 sra r4,r4,0x10
0x000a6034 sub r4,r6,r4
0x000a6038 sh r4,0x0012(r3)
0x000a603c lh r6,0x0000(r3)
0x000a6040 addu r4,r2,r0
0x000a6044 sll r5,r6,0x01
0x000a6048 mult r4,r5
0x000a604c mfhi r4
0x000a6050 srl r5,r5,0x1f
0x000a6054 sra r4,r4,0x05
0x000a6058 addu r4,r4,r5
0x000a605c sll r4,r4,0x10
0x000a6060 sra r4,r4,0x10
0x000a6064 sub r4,r6,r4
0x000a6068 sh r4,0x0000(r3)
0x000a606c lh r6,0x0002(r3)
0x000a6070 addu r4,r2,r0
0x000a6074 sll r5,r6,0x01
0x000a6078 mult r4,r5
0x000a607c mfhi r4
0x000a6080 srl r5,r5,0x1f
0x000a6084 sra r4,r4,0x05
0x000a6088 addu r4,r4,r5
0x000a608c sll r4,r4,0x10
0x000a6090 sra r4,r4,0x10
0x000a6094 sub r4,r6,r4
0x000a6098 sh r4,0x0002(r3)
0x000a609c lh r6,0x0004(r3)
0x000a60a0 addu r4,r2,r0
0x000a60a4 sll r5,r6,0x01
0x000a60a8 mult r4,r5
0x000a60ac mfhi r4
0x000a60b0 srl r5,r5,0x1f
0x000a60b4 sra r4,r4,0x05
0x000a60b8 addu r4,r4,r5
0x000a60bc sll r4,r4,0x10
0x000a60c0 sra r4,r4,0x10
0x000a60c4 sub r4,r6,r4
0x000a60c8 sh r4,0x0004(r3)
0x000a60cc lh r5,0x0006(r3)
0x000a60d0 nop
0x000a60d4 sll r4,r5,0x01
0x000a60d8 mult r2,r4
0x000a60dc mfhi r2
0x000a60e0 srl r4,r4,0x1f
0x000a60e4 sra r2,r2,0x05
0x000a60e8 addu r2,r2,r4
0x000a60ec sll r2,r2,0x10
0x000a60f0 sra r2,r2,0x10
0x000a60f4 sub r2,r5,r2
0x000a60f8 sh r2,0x0006(r3)
0x000a60fc lh r2,0x0010(r3)
0x000a6100 nop
0x000a6104 bgtz r2,0x000a6114
0x000a6108 nop
0x000a610c addiu r2,r0,0x0001
0x000a6110 sh r2,0x0010(r3)
0x000a6114 lh r2,0x0012(r3)
0x000a6118 nop
0x000a611c bgtz r2,0x000a612c
0x000a6120 nop
0x000a6124 addiu r2,r0,0x0001
0x000a6128 sh r2,0x0012(r3)
0x000a612c lh r2,0x0000(r3)
0x000a6130 nop
0x000a6134 bgtz r2,0x000a6144
0x000a6138 nop
0x000a613c addiu r2,r0,0x0001
0x000a6140 sh r2,0x0000(r3)
0x000a6144 lh r2,0x0002(r3)
0x000a6148 nop
0x000a614c bgtz r2,0x000a615c
0x000a6150 nop
0x000a6154 addiu r2,r0,0x0001
0x000a6158 sh r2,0x0002(r3)
0x000a615c lh r2,0x0004(r3)
0x000a6160 nop
0x000a6164 bgtz r2,0x000a6174
0x000a6168 nop
0x000a616c addiu r2,r0,0x0001
0x000a6170 sh r2,0x0004(r3)
0x000a6174 lh r2,0x0006(r3)
0x000a6178 nop
0x000a617c bgtz r2,0x000a618c
0x000a6180 nop
0x000a6184 addiu r2,r0,0x0001
0x000a6188 sh r2,0x0006(r3)
0x000a618c lh r2,0x0010(r3)
0x000a6190 lh r4,0x0014(r3)
0x000a6194 nop
0x000a6198 slt r1,r4,r2
0x000a619c bne r1,r0,0x000a61a8
0x000a61a0 addu r5,r2,r0
0x000a61a4 sh r5,0x0014(r3)
0x000a61a8 lh r2,0x0012(r3)
0x000a61ac lh r4,0x0016(r3)
0x000a61b0 nop
0x000a61b4 slt r1,r4,r2
0x000a61b8 bne r1,r0,0x000a61c4
0x000a61bc addu r5,r2,r0
0x000a61c0 sh r5,0x0016(r3)
0x000a61c4 lui r1,0x8014
0x000a61c8 lw r3,-0x7ba0(r1)
0x000a61cc nop
0x000a61d0 andi r2,r3,0x0010
0x000a61d4 beq r2,r0,0x000a6220
0x000a61d8 nop
0x000a61dc lui r1,0x8014
0x000a61e0 lh r2,-0x7b76(r1)
0x000a61e4 nop
0x000a61e8 bltz r2,0x000a6220
0x000a61ec nop
0x000a61f0 addiu r2,r0,0xffef
0x000a61f4 and r2,r3,r2
0x000a61f8 lui r1,0x8014
0x000a61fc sw r2,-0x7ba0(r1)
0x000a6200 addiu r2,r0,0x0001
0x000a6204 lui r1,0x8015
0x000a6208 lw r4,-0x6ecc(r28)
0x000a620c sb r2,0x57d7(r1)
0x000a6210 jal 0x000e9fb4
0x000a6214 nop
0x000a6218 addiu r2,r0,0xffff
0x000a621c sw r2,-0x6ed8(r28)
0x000a6220 lw r31,0x0014(r29)
0x000a6224 lw r16,0x0010(r29)
0x000a6228 jr r31
0x000a622c addiu r29,r29,0x0018